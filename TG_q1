import pandas as pd

# Lire le fichier CSV
donnees = pd.read_csv("athlete_events.csv")

# question : quel sportif a participé au plus d'épreuves sans jamais être médaillé ?

# Séparer les données en fonction de la médaille
donnees_medaille = donnees[donnees['Medal'].isin(['Gold', 'Silver', 'Bronze'])]
donnees_autre = donnees[~donnees['Medal'].isin(['Gold', 'Silver', 'Bronze'])]

# Fusionner les deux DataFrames en ne gardant que les lignes de donnees_autre
donnees_resultat = pd.merge(donnees_medaille, donnees_autre, how='right', on='ID',
                            indicator=True)

# Garder uniquement les lignes qui sont présentes dans donnees_autre mais pas dans
# donnees_medaille
donnees_resultat = donnees_resultat[donnees_resultat['_merge'] == 'right_only']

# Supprimer la colonne '_merge' utilisée pour l'indicateur de fusion
donnees_resultat = donnees_resultat.drop(columns=['_merge'])

# Afficher le DataFrame résultant
print(donnees_resultat)

# Compter les occurrences de chaque ID
occurrences = donnees_resultat['ID'].value_counts(dropna=False)

# Extraire les 10 ID les plus fréquents
top_10_id = occurrences.head(10).index

# Filtrer les lignes du DataFrame pour ne garder que celles qui ont les 10 ID
# les plus fréquents
donnees_top_10 = donnees_resultat[donnees_resultat['ID'].isin(top_10_id)]

# Exporter le résultat dans un fichier CSV
donnees_top_10.to_csv('top_10_id.csv', sep=';', encoding='utf-8', index=False)
